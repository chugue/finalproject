{{> /layout/header}}


<div class="container">
    <div class="row justify-content-center mt-5">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    회원가입
                </div>
                <div class="card-body">
                    <form action="/join" method="post">
                        <div class="form-group">
                            <label for="name">이름</label>
                            <input type="text" class="form-control" id="name" name="name" placeholder="이름을 입력하세요">
                        </div>
                        <div class="form-group">
                            <label for="email">이메일 주소</label>
                            <div class="d-flex form-group">
                                <div class="d-flex align-items-center">
                                    <input type="email" class="form-control flex-grow-1 mr-2" id="email" name="email" style="width: 395px" placeholder="이메일을 입력하세요">
                                </div>
                                <div>
                                    <button type="button" onclick="emailSameCheck()" class="btn btn-primary">중복 체크</button>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="password">비밀번호</label>
                            <input type="password" class="form-control" id="password" name="password" placeholder="비밀번호를 입력하세요">
                        </div>
                            <!-- 자바 스크립트 처리해야됨 -->
                        <div class="form-group">
                            <label for="confirm_password">비밀번호 확인</label>
                            <input type="password" class="form-control" id="confirm_password"
                                   placeholder="비밀번호를 다시 입력하세요">
                        </div>
                        <div class="form-group">
                            <label for="businessNum">사업자 번호</label>
                            <input type="businessNum" class="form-control" id="businessNum" name="businessNum" placeholder="브랜드명을 입력하세요">
                        </div>
                        <div class="form-group">
                            <label for="brandName">브랜드 이름</label>
                            <input type="brandName" class="form-control" id="brandName" name="brandName" placeholder="브랜드명을 입력하세요">
                        </div>
                        <div class="form-group">
                            <label for="role">역할</label>
                            <select class="form-control" id="role" name="role">role
                                <option value="ADMIN">ADMIN</option>
                                <option value="BRAND">BRAND</option>
                            </select>
                        </div>
                        <button type="submit" onclick="valid()" class="btn btn-primary btn-block">가입하기</button>
                        <div class="text-center mt-3">
                            <a href="/login-form">이전</a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

{{> /layout/footer}}

<!-- 회원가입 -->
<script>

    <!--  아이디 중복체크  -->
    let isSameCheck = false;

    function valid() {
        if (isSameCheck == false) {
            alert("아이디 중복체크를 해야 합니다");
        }
        return isSameCheck;
    }

    function emailSameCheck() {
        let email = $('#email').val();

        if (email.trim() === "") {
            if (password.trim() === "" ) {
                if (address.trim() === "") {
                    alert("아이디를 입력해야 합니다");
                }
            }
        }

        console.log(email);
        $.ajax({
            url: "/api/email-same-check?email=" + email,
            type: "get"
        }).done((res) => {
            console.log(res);
            if (res.body == true) {
                isSameCheck = true;
                alert("회원가입 가능한 아이디 입니다.");
            } else {
                isSameCheck = false;
                alert("동일한 아이디가 존재합니다");
            }
        }).fail((res) => {
            alert(res.responseJSON.msg);
        });
    }

    <!--  유효성 검사  -->
    function valid() {
        // 이메일과 비밀번호 입력란의 값을 가져옵니다.
        var email = document.getElementById('email').value;
        var password = document.getElementById('password').value;

        // 이메일과 비밀번호가 비어 있는지 확인합니다.
        if (email.trim() === '' || password.trim() === '') {
            // 비어 있다면 경고 메시지를 표시합니다.
            alert('이메일과 비밀번호를 입력하세요.');
            // 폼 제출을 중단합니다.
            return false;
        }
        // 폼을 제출합니다.
        return true;
    }
</script>